var app = angular.module('rpi3', ['n3-line-chart']);

app.controller('rpi3Ctrl', function($scope, $http) {
    $scope.data = [];
    // Get all measurements
    $http({
        method: 'GET',
        url: '/db/env_sensors'
    }).then(function (response) {
        $scope.data = response;
        $scope.apply();
    }, function (response) {
        console.log('Error: ' + response);
    });

    $scope.options0 = {
       margin: {top: 5},
        series: [
            {
                axes: "y",
                dataset: "data",
                key: "temperature",
                label: "Temperature Fahrenheit",
                color: "#cc2200",
                thickness: "5px",
                type: ['line', 'area'],
                id: 'tempSeries'
            }
        ],
        grid: { 
            x: true,
            y: true
        },
        axes: {
            x: { key: "id" }
        },
        tooltipHook: function(d) {
            return {
                abscissas: "Data Point",
                rows: d.map(function(s) {
                    return {
                        label: "Value", 
                        value: s.row.y1,
                        id: s.series.id,
                        color: s.series.color
                    }
                })
            }
        }
    };

    $scope.options1 = {
        margin: {top: 5},
        series: [
           {
               axes: "y",
               dataset: "data",
               key: "humidity",
               label: "Humidity Data",
               color: "#22cc00",
               thickness: "5px",
               type: ['line', 'area'],
               id: 'humiditySeries'
           }

        ],
        grid: {
            x: true,
            y: true
        },
        axes: {
            x: {key: "id"}
        }
    };
    $scope.options2 = {
        margin: {top: 5},
        series: [
           {
               axes: "y",
               dataset: "data",
               key: "pressure",
               label: "Pressure Data",
               color: "#0022cc",
               thickness: "5px",
               type: ['line', 'area'],
               id: 'pressureSeries'
           }

        ],
        grid: {
            x: true,
            y: true
        },
        axes: {
            x: {key: "id"}
        }
    };
    
});

